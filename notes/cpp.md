C++ Programming Tricks
=================

### Output file and line to console:

    ROS_ERROR("Failed to call service %s at %s:%d",
      service_name.c_str(),
      __FILE__,
      __LINE__);

### See the contents of a cpp library

    ldd libmoveit_manipulation_visualization.so | grep ros

### Debugging Tool

a useful diagnostic, instructional, and debugging tool.  System administrators, diagnosticians and trouble-shooters will find it invaluable for solving problems with programs for which  the  source  is  not  readily
available  since they do not need to be recompiled in order to trace them.  Students, hackers and the overly-curious will find that a great deal can be learned about a system and its system calls by tracing even ordinary pro‚Äê
grams.  And programmers will find that since system calls and signals are events that happen at the user/kernel interface, a close examination of this boundary is very useful for bug isolation, sanity checking and  attempting
to capture race conditions.

    strace

### CPP Code Testing

Running C++ code coverage

Before you can generate a code coverage report, you first need to add a few lines in your CMakeLists.txt. In the if(CATKIN_ENABLE_TESTING) block, add the following lines,

include(CodeCoverage)
coverage_add_target(run_tests_${PROJECT_NAME})
After adding to the CMakeLists.txt, the two main things now are that you need to supply the -DCMAKE_BUILD_TYPE=Coverage and --make-args run_coverage_<my_pkg>. Here is a simple example using catkin-tools(should work for regular catkin also though). First build the workspace,

catkin build -s
Now run the coverage build,

catkin run_tests --no-deps <my_pkg> -DCMAKE_BUILD_TYPE=Coverage --make-args run_coverage_<my_pkg>

Auto Reformat C++ and Python code

To use the auto formatting functionality, first in your projects CMakeLists.txt file you'll need to include the cmake module,

include(CodeFormat)
then you can call the format code macro,

format_code_target(${list_of_cpp_files})
where list_of_cpp_files is the list of files to be reformatted and can be easily generated with GLOB. Note that it will automatically crawl the projects
directories to find python files, so you don't need to add those manually. Now simply build your package with the correct make args,

catkin build --no-deps <my_pkg> --make-args format_code_<my_pkg>
Keep in mind this will have overwritten your source files, so you'll need to go add/commit the changes.

Run C++ Code Static Analysis

If your package is a catkin package and your include files are in the include directory, these lines would look like the following,

if(CATKIN_ENABLE_TESTING)
include(CodeAnalysis)
lint_cpp(
INCLUDE_DIRS ${PROJECT_SOURCE_DIR}/include
SRCS ${cpp_files})
endif()
Now you build of your package and the run_tests target generated by catkin.

$ catkin build <my_pkg>
$ catkin run_tests <my_pkg>
The lint results are in ~/ws/build/<my_pkg>/test_results/<my_pkg>/.. Or if you just want to see if everything is kosher, build the test target:

$ catkin test <my_pkg> --no-deps
